<% 
    users.sort((first, second) => {
        if (first.nrOfScans > second.nrOfScans) return -1
        else if (first.nrOfScans < second.nrOfScans) return 1
        else return 0
    })
    const TYPE_CUP_OF_ICE_CREAM = 1
    const TYPE_EXTRA_CREAM = 2
    const TYPE_EXTRA_SCOOP = 3
    const TYPE_SURPRISE = 4

    let types = [0, 0, 0, 0]
    let total = 0

    users.forEach(user => {
        switch (user.rewardType) {
            case TYPE_CUP_OF_ICE_CREAM:
                types[0]++
                total++
                break;
            case TYPE_EXTRA_CREAM:
                types[1]++
                total++
                break;
            case TYPE_EXTRA_SCOOP:
                types[2]++
                total++
                break;
            case TYPE_SURPRISE:
                types[3]++
                total++
                break;
        }    
    })
    
%> 

<div class="col">
    <div class="progress mb-2">
        <div class="progress-bar type-0" style="width: <%= types[0]/total*100 %>%;"></div>
        <div class="progress-bar type-1" style="width: <%= types[1]/total*100 %>%;"></div>
        <div class="progress-bar type-2" style="width: <%= types[2]/total*100 %>%;"></div>
        <div class="progress-bar type-3" style="width: <%= types[3]/total*100 %>%;"></div>
    </div>
    <% users.forEach(user => { %> 
        <div class="input-group mb-1">
            <div class="input-group-prepend fixed-width">
                <div class="input-group-text fixed-width"><%= user.username %> </div>
            </div>
            <div class="form-control text-right username">
                <%= user.nrOfScans %>
            </div>
            <div class="input-group-append">
                <a class="btn btn-custom" target="_blank" onclick="getUser('<%= user.username %>')">
                    <i class="fas fa-chevron-right"></i>
                </a>
            </div>
        </div>
    <% }) %> 
</div>